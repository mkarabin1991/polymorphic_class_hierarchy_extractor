# polymorphic_class_hierarchy_extractor
This is an IDC script for IDA disassembler which extracts the C++ class hierarcy of polymorphic classes as they are mapped from IDA via constructor analysis.

The script initially marks all functions, including the constructors inside the binary segment, the for each function-constructor it identifies all function calls, examining the cross references. If a function call takes place after a call to new(), it indicates that this functioon call is a call to a constructor. If there is a call inside a constructor and the callee has certain names indicating a constructor, generated by the compiler, it is also declared a constructor. Finally the inheritance relation between classes is extracted from the calls to constructors that take place inside constructors.

The reason behind this script is that the virtual function tables (vTables) of C++ are stored in the heap which is not as well protected as the stack, resulting in many exploits targeting it for code execution, etc. By only knowing at run time which virtual method will be executed, it is hard to implement transparent CFI protection. But it would help if the defender could get the class hierarchies from the binary. 
